---
title: "9.5 连接迁移对隐私的影响"
anchor: "9.5_Privacy_Implications_of_Connection_Migration"
weight: 950
rank: "h2"
---

在不同网络路径上使用相同的连接ID将允许被动观测者从那些路径上将网络活动互相关联起来。在不同网络间移动的终端可能不希望它们的网络活动被不是对端的任何实体给关联起来，所以当从不同的本地地址发送时，会使用不同的连接ID，如[第5.1章](#5.1_Connection_ID)所讨论的那样。为了使这个方法有效，终端应该确保它们提供的那些连接ID不会被任何其他实体找出相关性。

终端随时{{< req_level MAY >}}改变传输时所用的目标连接ID为一个从未在别的路径上使用过的值。

当发送自不止一个本地地址时——例如在如[第9.2章](#9.2_Initiating_Connection_Migration)所描述的发起连接迁移时或在如[第9.1章](#9.1_Probing_a_New_Path)所描述的探测新网络路径时——终端{{< req_level MUST_NOT >}}重用连接ID。

类似地，当发送至不止一个目标地址时，终端{{< req_level MUST_NOT >}}重用连接ID。由于不受对端控制的网络条件变化，终端可能从一个新的源地址接收到具有相同目标连接ID字段值的数据包，这时它{{< req_level MAY >}}在使用新的远程地址时继续使用当前连接ID，但是仍然从相同的本地地址发送。

以上有关重用连接ID的要求仅适用于数据包发送，因为数据包发送时的连接ID不变但是数据包传输的路径发生意想不到的变化的情况是有可能的。例如，在网络经过一段时间的沉默后，客户端恢复发送时，NAT重绑定可能使得数据包在一条新路径上被发送。终端如[第9.3章](#9.3_Responding_to_Connection_Migration)所描述的那样响应这类事件。

为每条新网络路径上双向发送的数据包使用不同的连接ID消除了连接ID对于从不同网络路径中的相同连接间将数据包互相关联的作用。而头部保护确保了数据包号不能被用来关联网络活动。但这无法阻止数据包的其他属性，例如计时和尺寸，被用于关联网络活动。

终端{{< req_level SHOULD_NOT >}}在对端申请了零长度连接ID时发起迁移，因为经过新路径的流量与经过旧路径的会很容易地被关联起来。如果服务器有能力将具有零长度连接ID的数据包与正确的那条连接关联起来，那么这就意味着服务器正使用其他信息来解除数据包的多路复用。举个例子，服务器可以给每个客户端提供唯一的地址——比如通过使用HTTP替代服务（详见《[ALTSVC](https://www.rfc-editor.org/info/rfc7838)》）。这类能允许不同网络路径上的数据包被正确路由的信息同样能允许非对端的实体关联这些路径上的网络活动。

在沉默一段时间后，客户端在发送流量时可能希望通过切换至新连接ID、源UDP端口或IP地址（详见《[RFC8981](https://www.rfc-editor.org/info/rfc8981)》）的方法减少网络活动的可关联性。改变用来发送数据包的地址同时会使得服务器检测到连接迁移。这确保了用于支持迁移的机制即使是对没有经历NAT重绑定或实际迁移的客户端来说也是用得上的。改变地址会使得对端重置它的拥塞控制状态（详见[第9.4章](#9.4_Loss_Detection_and_Congestion_Control)），所以地址{{< req_level SHOULD >}}仅偶尔地被改变。

耗尽可用连接ID的终端既不能探测新路径或发起迁移，也不能响应探测包或对端发起的迁移。为了确保迁移可行并且在不同路径上发送的数据包不会被关联，终端{{< req_level SHOULD >}}在对端迁移前提供新连接ID，详见[第5.1.1章](#5.1.1_Issuing_Connection_IDs)。如果对端可能已经耗尽了可用的连接ID，正在迁移的那个终端可以在所有在新网络路径上发送的数据包中包含一个**新连接ID帧**。
