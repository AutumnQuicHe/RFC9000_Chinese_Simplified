---
title: "9.3.2 来自路径上设备的地址伪造"
anchor: "9.3.2_On-Path_Address_Spoofing"
weight: 932
rank: "h3"
---

在路径上的攻击者可以通过拷贝并转发具有伪造地址的数据包并使它比原始数据包更早到达的方式引发虚假的连接迁移。具有伪造地址的数据包将被视为来自连接迁移，而原始数据包将被视为重复并被丢弃。在一次虚假迁移之后，对源地址的验证将会失败，因为在源地址上的实体没有读取或响应发给它的**通道挑战帧**所需的加密密钥，哪怕它真的想这么做。

为了保护连接免于因为这样的虚假迁移而失败，当对于新对端地址的验证失败后，终端{{< req_level MUST >}}回退并使用最后一个经验证的对端地址。除此之外，从合法对端地址接收到具有最大数据包号的数据包，将触发另一次连接迁移。这将使得对虚假迁移的地址的验证被放弃，其中正包括由注入单个数据包的攻击者发起的迁移。

如果终端没有关于最后一个经验证的对端地址的状态，它{{< req_level MUST >}}以丢弃所有此连接的状态数据的方式静默地关闭连接。这会造成这条连接上的新数据包被以常规方式处理。例如，终端{{< req_level MAY >}}在响应将来的传入数据包时发送无状态重置。
