---
title: "10.3.1 检测无状态重置"
anchor: "10.3.1_Detecting_a_Stateless_Reset"
weight: 1031
rank: "h3"
---

终端使用UDP数据报末尾的16个字节检测可能的无状态重置。终端记录所有无状态重置令牌，这些令牌关联着连接ID和终端最近发送的数据报的目标远程地址。这些令牌来自**新连接ID帧**的无状态重置令牌字段和服务器的传输参数，但不包含那些与未使用的或已停用的连接ID关联的无状态重置令牌。终端通过比较数据报的最后16个字节和所有与发送数据报的远程地址关联的无状态重置令牌，来将接收到的数据报识别为无状态重置。

这种比较可以为每个传入数据报进行。如果来自某个数据报的数据包被成功处理了，那么终端{{< req_level MAY >}}跳过这个检查。然而，如果一个传入数据报的首个数据包不能与一条连接关联上，或不能被解密，那么{{< req_level MUST >}}进行这种比较。

终端{{< req_level MUST_NOT >}}为任何关联到它尚未使用或已停用的连接ID上的无状态重置令牌做检查。

在将数据报和无状态重置令牌的值比较时，终端{{< req_level MUST >}}在不泄露令牌的值的前提下进行比较。比如，用固定时间进行比较能保护无状态重置令牌免于利用计时侧信道的信息泄露。另一种方法是存储并比较经转换的无状态重置令牌值而不是原始的令牌值，这种转换指的是使用密钥并在密码学上安全的伪随机函数（例如数据块加密算法和散列消息认证码（HMAC，详见《[RFC2104]()》））。终端不必保护有关数据包是否被成功解密和有效的无状态重置令牌数量的信息。

如果数据报的最后16个字节与无状态重置令牌的值一致，那么终端{{< req_level MUST >}}进入排空状态，并且在此连接上不再发送数据包。
