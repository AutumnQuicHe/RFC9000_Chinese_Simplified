---
title: "21.2. 针对握手的拒绝服务攻击"
anchor: "21.2_Handshake_Denial_of_Service"
weight: 210200
rank: "h2"
---

作为一种经加密和认证的传输层协议，QUIC针对拒绝服务提供了诸多保护措施。一旦加密握手完成，QUIC终端就会丢弃绝大多数未经认证的数据包，极大地限制了攻击者介入已建立的连接的能力。

在连接被建立后，QUIC终端可以接受一些未经认证的ICMP数据包（详见[第14.2.1章](#14.2.1_Handling_of_ICMP_Messages_by_PMTUD)），但是对这些数据包的使用是极度受限的。终端可以接受的另一种数据包是无状态重置（详见[第10.3章](#10.3_Stateless_Reset)），它依赖于在令牌被使用前保持令牌的机密性。

在创建连接期间，QUIC提供的保护仅针对不在路径上的攻击。所有的QUIC数据包都包含着能表明终端接收到了来自对端的前序数据包的依据。

在握手期间无法更改地址，所以终端可以丢弃另一条网络路径上接收到的数据包。

在握手期间，源连接ID字段和目标连接ID字段是抵御不在路径上的攻击的主要手段；详见[第8.1章](#8.1_Address_Validation_during_Connection_Establishment)。这些字段必须与对端填写的对应字段匹配。除了初始数据包和无状态重置外，终端只接受包含着与终端之前选择的值匹配的目标连接ID字段的数据包。这是为版本协商数据包提供的唯一保护。

初始数据包中的目标连接ID字段是由客户端选择的不可预测的值，它起着额外的作用。传递加密握手消息的数据包会受到密钥的保护，该密钥衍生自此连接ID和由QUIC版本指定的盐。这使得终端在加密握手完成后始终使用一致的计算过程来认证接收到的数据包。未能通过认证的数据包会被丢弃。以这种方式保护数据包能提供一种强有力的保证，保证数据包的发送方接收到了初始数据包并且能够理解它。

这些保护在面对有能力在连接建立前就接收到QUIC数据包的攻击者时并不一定有效。这样的攻击者可能发送出会被QUIC终端接受的数据包。本QUIC版本尝试检测出此类攻击，但是终端应该令连接的建立过程直接失败，而不是试图从中恢复。在握手期间检测出篡改行为的责任主要在于加密握手协议（详见《[QUIC-TLS](https://www.rfc-editor.org/info/rfc9001)》）。

允许终端使用其他手段来检测出握手被介入的情况并尝试从中恢复。非法数据包可以被其他手段识别出来并被丢弃，不过在本文档中没有推荐什么特别的方法。
