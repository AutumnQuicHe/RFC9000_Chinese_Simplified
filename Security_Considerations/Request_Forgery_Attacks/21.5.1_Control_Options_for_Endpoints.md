---
title: "21.5.1. 控制终端的途径"
anchor: "21.5.1_Control_Options_for_Endpoints"
weight: 210510
rank: "h3"
---

QUIC给了攻击者一些影响或操纵其对端的UDP数据报发送目标的机会：

* 初始的连接建立（详见[第7章]()），此时服务器拥有操纵客户端的数据包发送目标的能力——例如，通过填写DNS记录的方式；

* 首选地址（详见[第9.6章]()），此时服务器拥有操纵客户端的数据包发送目标的能力；

* 虚假的连接迁移（详见[第9.3.1章]()），此时客户端具有使用伪造的源地址来操纵服务器后续数据报的发送目标的能力；以及

* 伪造的数据包，这能令服务器发送版本协商数据包（详见[第21.5.5章]()）。

在任一情况下，攻击者都能令其对端向某个受害者发送数据报，无论受害者能不能理解QUIC。也就是说，这些数据包会在对端进行地址验证前就被发送出去；详见[第8章]()。

在数据包经加密的部分之外，QUIC给予了终端一些可选项，用于控制其对端发送的UDP数据报的内容。目标连接ID字段提供了针对对端发送的数据包中位置靠前的字节的直接控制；详见[第5.1章]()。初始数据包中的令牌字段提供了针对初始数据包中其他字节的控制；详见[第17.2.2章]()。

在本QUIC版本中没有任何方法来阻止针对数据包中经加密的部分的间接控制。假定终端能够控制对端所发送的帧内容是很有必要的，尤其是那些传递应用数据的帧，例如**流帧**。尽管它在一定程度上依赖于应用协议的细节部分，但是在多数协议的使用场景中都有可能出现某种程度的控制能力。只要攻击者能访问到数据包保护密钥，它们就有能力预测对端会如何加密后续数据包。于是，要成功控制数据报内容，只需要攻击者有能力预测数据包号和数据包中的帧大概会出现的位置。

本节假定了我们无法限制攻击者对数据报内容的控制。在后续章节中，抵御手段的重点在于限制数据报会在进行地址验证前就被发送出去的情况，以防止它们被用于进行请求伪造。
