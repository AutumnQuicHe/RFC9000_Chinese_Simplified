---
title: "3.4. 双向流状态"
anchor: "3.4_Bidirectional_Stream_States"
weight: 340
rank: "h2"
---

双向流同时包括接收部分和发送部分。
QUIC的实现可以将双向流的状态表示成发送及接收流状态的组合状态。
在最简单的模型里，当发送和接收部分均处在非最终状态时，表示流处于“打开”状态；当两者均处于最终状态时，表示流处于“关闭”状态。

[表2](#Table_2_Possible_Mapping_of_Stream_States_to_HTTP2)展示了一个更复杂的双向流状态映射，粗略对应HTTP/2（[HTTP2](https://www.rfc-editor.org/info/rfc7540)）中定义的流状态。
这表明流的发送或接收部分多个状态映射到同一个组合状态。
注意这仅仅是一个可能的映射，这种映射需要数据全部被确认后才能转入“关闭”或“半关闭”状态。

{{% block_ref
    indx="Table_2_Possible_Mapping_of_Stream_States_to_HTTP2"
    title="表2：流状态到HTTP/2间可能的映射方式" %}}

|发送部分|接收部分|组合状态|
|:------|:------|:-------|
|无流、就绪|无流、接收<sup>①</sup>|空闲|
|就绪、发送、发送完成|接收、数据量确认|打开|
|就绪、发送、发送完成|接收完成、读取完成|半关闭（对端）|
|就绪、发送、发送完成|重置接收、重置读取|半关闭（对端）|
|接收完成|接收、数据量确认|半关闭（本端）|
|重置发送、重置接收|接收、数据量确认|半关闭（本端）|
|重置发送、重置接收|接收完成、读取完成|关闭|
|重置发送、重置接收|重置接收、重置读取|关闭|
|接收完成|接收完成、读取完成|关闭|
|接收完成|重置接收、重置读取|关闭|

{{% /block_ref %}}

> 注意（①）：如果一条流尚未被创建或其接收部分处于“接收”状态而尚未收到任何帧，则流处于“空闲”状态。