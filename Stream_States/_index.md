---
title: "3. 流状态"
anchor: "3_Stream_States"
weight: 300
rank: "h1"
---

本章描述流的发送及接收相关组件。
有两个状态机需要描述：一个是关于终端传输数据（[第3.1章]()）的流，另一个是关于终端接收数据（[第3.2章]()）的流。

单向流用到发送或接收的其中一个状态机，取决于流类型及终端角色。
双向流双端都会用到两个状态机。
在极大程度上，不论单向流还是双向流，在使用这两个状态机上是没有区别的。
相对而言打开一条双向流会稍微复杂一些，因为同时打开发送和接收端意味着在两个方向上同时打开流。

本章展示的状态机极具信息量。
本文使用流状态描述不同类型帧在何时以何种方式发送的相关规则，以及当收到不同类型的帧时应作出的反应。
即使这些状态机目的在于指导如何实现QUIC协议，但其并不意味着限制QUIC实现的方式。
一个QUIC实现完全可以定义不同的状态机，只要其行为与本文所述状态机的具体实现一致即可。

> 注意：在某些情况下，单个事件或操作可能导致多个状态转换。
> 例如，对于流的发送端，如果发送一个FIN置位的**流帧**可能导致两个状态转换：
> 从“就绪”状态转到“发送”状态，然后从“发送”状态转到“数据发送完毕”状态。
