---
title: "3.5. 请求状态转换"
anchor: "3.5_Solicited_State_Transitions"
weight: 350
rank: "h2"
---

如果应用层不再需要流接收到的数据，应用层可以中止流的读取，并指定一个应用层错误码。

如果流处在“接收”或“数据量确认”状态，传输层{{< req_level SHOULD >}}发送一个**停止发送帧**通知对端及时在反方向关闭流。
这通常表明接收方应用层不再读取流接收到的数据，但这并不意味着传入的数据一定会被忽略。

在发送完**停止发送帧**后收到的**流帧**仍然会被连接及流级别的流量控制统计，即使这些帧可能在接收时即被丢弃。

**停止发送帧**请求接收端发送一个**流重置帧**。
如果流处在“就绪”或“发送”状态，收到**停止发送帧**的一端{{< req_level MUST >}}发送一个**流重置帧**。
如果流处在“发送完成”状态，终端{{< req_level MAY >}}推迟发送**流重置帧**直到含有未发完数据的数据包被确认或明确的被丢弃。
如果任何未发完数据得到明确被丢弃了，终端{{< req_level SHOULD >}}发送一个**流重置帧**而非重传数据。

终端{{< req_level SHOULD >}}从**停止发送帧**复制错误码到要发出的**流重置帧**，但是其可以使用任何应用层错误码。
发送**停止发送帧**的终端{{< req_level MAY >}}忽略任何随后被流接收到的**流重置帧**里的错误码。

**停止发送帧**{{< req_level SHOULD >}}只能在流尚未被对端重置前发送出去。
**停止发送帧**主要在流的“接收”或“数据量确认”状态使用。

如果包含前一个**停止发送帧**的数据包丢失了，终端应当发送另一个**停止发送帧**。
然而，一旦流收到了所有流数据或一个**流重置帧**——也就是说流处在“接收”或“数据量确认”之外的状态——发送**停止发送帧**就不再必要了。

如果双向流的一端想要将流的两个方向同时关闭，那么其可以通过发送一个**流重置帧**关闭一个方向，并发送一个**停止发送帧**促使相反方向也迅速得到关闭。