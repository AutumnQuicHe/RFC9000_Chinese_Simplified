---
title: "19.6 加密帧"
anchor: "19.6_CRYPTO_Frames"
weight: 190600
rank: "h2"
---

**加密帧**（CRYPTO frame，类型是`0x06`）用于传输加密握手信息。
其可以被除0-RTT包以外的其他类型包发送。
**加密帧**为加密协议提供了一个有序的字节流。
**加密帧**除了不携带流标识符（流ID）、不进行流控，以及不携带可选偏移量、可选长度及流结束标记外，它们在功能上与**流帧**完全相同。

**加密帧**格式如[图30](#Figure_30_CRYPTO_Frame_Format)所示。

{{% block_ref
    indx="Figure_30_CRYPTO_Frame_Format"
    title="图30：加密帧格式" %}}

```
加密帧 {
  类型 (i) = 0x06,
  偏移 (i),
  长度 (i),
  加密数据 (i),
}
```

{{% /block_ref %}}

**加密帧**包含下述字段：

偏移（Offset）：

:   一个可变长度整型值，表示**加密帧**中加密数据在数据流中的字节偏移量。

长度：

:   一个可变长度整型值，表示**加密帧**的加密数据字段携带数据长度。

加密数据（Crypto Data）：

:   加密信息数据。

每个加密级别都有一条单独的加密握手数据流，每条流都从偏移量0开始。
也就是说每个加密级别都被视为一条单独的加密数据流。

这样的数据流其最大偏移量——偏移量与数据长度之和——不能超过<code>2<sup>26</sup>-1</code>。
收到一个超过此上限的的帧{{< req_level MUST >}}视为一个`FRAME_ENCODING_ERROR`类型或`CRYPTO_BUFFER_EXCEEDED`类型的连接错误。

不同于**流帧**有着流ID用以区分数据属于哪条流，**加密帧**为每个加密级别携带单条流的数据。
数据流没有一个明确的结束点，所以**加密帧**没有FIN位。
